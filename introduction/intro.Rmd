---
title: "Entry level R maps from African data"
author: "afrimapr"
date: "07 July 2021"
output:
  xaringan::moon_reader:
    includes:
      after_body: insert-logo.html
    self_contained: true
    css: ["useR", "useR-fonts"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

class: center, middle

# Session one

## 'Introduction to spatial data'


---

## Overview

- R mapping functions

- different spatial data types

- R packages to work with vector and raster data

- create static and interactive maps

- overlay several data types (layers) on a map

- how to change the colour palette to represent data on a map

---

## Plotting spatial data

- points (capital cities) 
- lines (highway network) 
- polygons (country boundaries) 
- gridded or raster data (population density)

```{r library_packages, echo=FALSE, message=FALSE}

#### SECTION B: LOADING PACKAGES AND DATA ----

library(sf) 
library(raster) 
library(afrilearndata)
library(tmap)
library(rgdal)
library(mapview)

```

```{r set tmap plot, echo=FALSE, message=FALSE}
tmap_mode("plot") 
```

```{r tmap-first-view, fig.height=3, dev='svg', echo=FALSE}

tmap::tm_shape(afripop2020) +
  tm_raster(palette = rev(viridisLite::magma(5)), breaks=c(0,2,20,200,2000,25000)) +
  tm_shape(africountries) +
  tm_borders("white", lwd = .5) +
  tm_shape(afrihighway) +
  tm_lines(col = "red") + 
  tm_shape(africapitals) +
  tm_symbols(col = "blue", alpha=0.4, scale = .6 )+
  tm_legend(show = FALSE)
```

---

### Examples

.pull-left[

```{r tmap-polygons-1c, fig.dim=c(4.8, 4.8), out.width="100%", echo=FALSE, message=FALSE}

tm_shape(africountries) +
  tm_polygons(col="income_grp", border.col = "white")

```

]

.pull-right[

```{r tmap-raster1b, fig.dim=c(4.8, 4.8), out.width="100%", echo=FALSE, message=FALSE}

tmap_mode('plot') 
tm_shape(afripop2020) +
  tm_raster(breaks=c(0,2,20,200,2000,25000))

```

]

---
### Examples


```{r set tmap plot2, echo=FALSE, message=FALSE}
tmap_mode("view") 
```

```{r tmap-interactive, fig.dim=c(4.8, 4.8), out.width="100%", echo=FALSE, message=FALSE, warning=FALSE}

tmap::tm_shape(afripop2020) +
  tm_raster(palette = rev(viridisLite::magma(5)), breaks=c(0,2,20,200,2000,25000)) +
  tm_shape(africountries) +
  tm_borders("white", lwd = .5) +
  tm_text("iso_a3", size = "AREA") +
  tm_shape(afrihighway) +
  tm_lines(col = "blue") + 
  tm_shape(africapitals) +
  tm_symbols(col = "green",  scale = .6 ) +
  tm_legend(show = FALSE)

```

---

class: center, middle

# Session two

## 'Reading my spatial data into R'

---

## Overview

- read in spatial data files for vector and raster data

- make a map from coordinate data, and read in other spatial data files

- the importance of CRS (Coordinate Reference System) to place data on a world map

- create static and interactive maps using the `mapview` package

- options for making `mapview` maps more useful

---

### Examples
### 

.pull-left[

```{r csv-airports1, fig.dim=c(4.8, 4.8), out.width="100%", echo=FALSE, message=FALSE}

filename <- system.file("extdata", "afriairports.csv", package="afrilearndata", mustWork=TRUE)
mydf <- readr::read_csv(filename)

mydf <- mydf[(1:100), ]

mysf <- sf::st_as_sf(mydf, 
                     coords=c("longitude_deg", "latitude_deg"),
                     crs=4326)
mapview(mysf)    

```


]

.pull-right[

```{r dataframe-sf, fig.dim=c(4.8, 4.8), out.width="100%", echo=FALSE, message=FALSE}

mydf <- data.frame(x=c(-10,10,30),
                   y=c(20,0,-20),
                   attribute=c("a","b","c"))

mysf <- sf::st_as_sf(mydf, 
                     coords=c("x", "y"),
                     crs=4326)

mapview(mysf)    

```

]

---

## Interactive maps


```{r mapview-options-airports, fig.height=4, dev='svg', echo=FALSE, message=FALSE}

# 1. read into dataframe
filename <- system.file("extdata", "afriairports.csv", package="afrilearndata", mustWork=TRUE)
mydf <- readr::read_csv(filename)

mydf <- mydf[(1:100), ] #select first 100 rows just to make quicker online

# or can select a single country:
# mydf <- mydf[which(mydf$country_name == "Burkina Faso"), ]

# 2. convert to sf object
mysf <- sf::st_as_sf(mydf, 
                     coords=c("longitude_deg", "latitude_deg"),
                     crs=4326)

# 3. quick interactive plot
#mapview(mysf)
mapview(mysf, zcol='type', label='name', cex=2)   

```

---

class: center, middle

# Session three

## Practical

---

## Overview

Make a map from data of your own choice

(data that you have brought with you, found online or that we have provided) 




